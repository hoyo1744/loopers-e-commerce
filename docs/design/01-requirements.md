# 🛒 Loopers 이커머스 요구사항 명세서

---

## 1. 개요

- 문서 목적 : Loopers 감성 이커머스 서비스에서 아래의 기능에 대한 요구사항을 정의함
    - 상품 목록 / 상품 상세 / 브랜드 조회
    - 상품 좋아요 등록 / 취소
    - 주문 생성 및 결제 흐름(재고 차감, 포인트 차감, 외부 시스템 연동)
- 정의 및 약어
    - 좋아요 : 사용자가 관심있는 상품을 저장해두는 기능
    - FR: Functional Requirements
    - 좋아요 등록된 상품은 관심 상품이라 정의합니다.
    - 기능 요구 사항에서 *파리미터는 ``Path Variable, Query Parameter, Header, RequestBody``  에서 요구하는 모든 변수를 의미합니다.
    - *내부 비지니스는 API는 존재하지 않고 내부 비지니스로직에서 호출되는 기능으로 정의합니다.

---

## 2.기능 요구 사항 (Fuctional Requirements)
| ID      | 기능명                | 설명                                                                                           | 제약 사항                                                                                   | 실패 케이스                                                                                                        | 파라미터                       | 입력값 설명                                                                                                 |
|---------|------------------------|------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------|--------------------------------|--------------------------------------------------------------------------------------------------------------|
| FR-001  | 상품 목록 조회         | 상품 목록을 조회합니다. 상품 목록 조회시, 브랜드, 정렬 기준, 페이지 개수, 현재 페이지로 조건 조회 | 조건 브랜드만 확인 가능, 정렬(최신순, 가격순, 좋아요순), 최대 100개 제한                     | 존재하지 않는 브랜드 선택시 오류                                                                                 | brandId, sort, page, size      | brandId: 브랜드 ID / sort: 정렬 기준(latest, price_desc, likes_desc) / page: 페이지 번호(기본 0) / size: 페이지 당 수(기본 20) |
| FR-002  | 상품 상세 조회         | 특정 상품 ID로 상세 정보를 조회합니다.                                                          | 없음                                                                                         | 존재하지 않는 상품                                                                                               | productId                      | productId: 상품 ID                                                                                          |
| FR-003  | 브랜드 조회            | 특정 브랜드 ID로 브랜드 정보를 조회합니다.                                                      | 없음                                                                                         | 존재하지 않는 브랜드                                                                                            | brandId                        | brandId: 브랜드 ID                                                                                        |
| FR-004  | 상품 좋아요 등록       | 사용자가 상품을 관심 목록에 추가                                                                | 회원만 가능                                                                                  | 비회원 / 존재하지 않는 상품                                                                                      | productId                      | productId: 상품 ID                                                                                        |
| FR-005  | 상품 좋아요 제거       | 관심 상품 목록에서 제거                                                                         | 회원만 가능                                                                                  | 비회원 / 존재하지 않는 상품                                                                                      | productId                      | productId: 상품 ID                                                                                        |
| FR-006  | 상품 좋아요 목록 조회  | 사용자의 관심 상품 목록 조회                                                                    | 회원만 가능                                                                                  | 비회원                                                                                                           | userId                         | userId: 사용자 ID                                                                                        |
| FR-007  | 주문 생성              | 상품 상세 조회 페이지에서 주문 생성                                                             | 회원만 가능                                                                                  | 비회원 / 존재하지 않는 상품 / 재고 부족 / 수량·ID 유효성 검증 실패                                               | productId, quantity            | productId: 상품 ID / quantity: 상품 수량                                                                   |
| FR-008  | 결제 요청              | 생성된 주문에 대한 결제 요청                                                                    | 회원만 가능, 주문이 생성되어 있어야 함                                                       | 비회원 / 주문 없음 / 중복 결제 / 결제 금액 부족                                                                 | orderId                        | orderId: 주문 번호                                                                                         |
| FR-009  | 주문 목록 조회         | 사용자가 자신의 주문 내역을 확인                                                                | 회원만 가능                                                                                  | 비회원                                                                                                           | userId                         | userId: 사용자 ID                                                                                        |
| FR-010  | 주문 상세 조회         | 특정 주문의 상세 정보 확인                                                                      | 회원만 가능                                                                                  | 비회원 / 주문 없음                                                                                               | orderId                        | orderId: 주문 번호                                                                                         |


---

## 3. 전역적 비기능 요구사항(Global Non-Functional Requirements)

| 기능 ID | 설명 | 항목 | 내용 |
| --- | --- | --- | --- |
| 공통 | 공통 | 오류 | 오류가 발생한 경우, HTTP 상태코드와 에러 메시지를 반환한다. |
| 공통 | 공통 | 인증 | 사용자 인증은 `X-USER_ID` 헤더 기반으로 처리한다. |

---

## 4. 기능별 비기능 요구사항(Scoped Non-Functional Requirements)
| 기능 ID | 설명                 | 항목       | 내용 |
|---------|----------------------|------------|------|
| FR-001  | 상품 목록 조회        | 정렬       | 기본 정렬 항목은 latest, like_desc, price_desc 으로 선택할 수 있습니다. |
|         |                      | 페이징     | 기본값 20개, 50, 100개 선택할 수 있습니다. |
|         |                      | 예외 처리  | 파라미터 누락 (400 에러), 존재하지 않는 브랜드 ID (404 에러) |
|         |                      | 조회       | 상품의 `좋아요` 수는 정수 단위로 노출하지 않고, 다음과 같이 축약 표기 방식을 따릅니다: 1,000 이상 → `1K`, `1.5K`, `2K`, 1,000,000 이상 → `1M`, `1.2M`, 소수 첫째 자리까지 표기 (예: `1.3K`, `1.0M`) |
| FR-002  | 상품 상세 조회        | 조회       | 상품의 `좋아요` 수는 정수 단위로 노출하지 않고, 다음과 같이 축약 표기 방식을 따릅니다: 1,000 이상 → `1K`, `1.5K`, `2K`, 1,000,000 이상 → `1M`, `1.2M`, 소수 첫째 자리까지 표기 (예: `1.3K`, `1.0M`) |
|         |                      | 예외 처리  | 파라미터 누락 (400 에러), 존재하지 않는 상품 (404 에러), 삭제된 상품 (410 에러) |
| FR-003  |                      | 예외 처리  | 파라미터 누락 (400 에러), 존재하지 않는 브랜드 ID (404 에러) |
| FR-004  | 상품 좋아요 등록      | 트랜잭션   | 좋아요 등록 시 원자적으로 처리되어야 합니다. 멱등하게 처리되어야 하며, 이미 등록된 경우 무시합니다. |
|         |                      | 예외 처리  | 미로그인 (401 에러), 중복 요청은 무시 (204 에러), 존재하지 않는 상품 (404 에러) |
| FR-005  | 상품 좋아요 제거      | 트랜잭션   | 좋아요 제거 시 원자적으로 처리되어야 하며, 멱등하게 처리되어야 함. 이미 제거된 경우 무시 |
|         |                      | 예외 처리  | 미로그인 (401 에러), 중복 요청은 무시 (204 에러), 존재하지 않는 상품 (404 에러) |
| FR-006  | 상품 좋아요 목록 조회 | 예외 처리  | 미로그인 (401 에러) |
| FR-007  | 주문 생성             | 트랜잭션   | 주문 생성 시 상품 수량 차감과 주문 레코드가 원자적으로 처리되어야 합니다. |
|         |                      | 예외 처리  | 미로그인 (401 에러), 존재하지 않는 상품 (404 에러), 재고 부족 (409), 상품 및 수량 유효성 검증 실패 (400 에러) |
| FR-008  | 결제 요청             | 외부 연동  | 결제 모듈과 통신 |
|         |                      | 예외 처리  | 미로그인 (401 에러), 결제 실패 (402 에러), 주문 미존재 (404 에러), 중복 결제 (409 에러) |
| FR-009  | 주문 목록 조회        | 예외 처리  | 미로그인 (401 에러) |
| FR-010  | 주문 상세 조회        | 예외 처리  | 미로그인 (401 에러), 주문 미존재 (404 에러) |


---

## 5. 사용자 시나리오

### ✅ [FR-001] 상품 목록 조회

**Actor** : 비회원 또는 회원

**시나리오** :

1. 브랜드 선택
2. 정렬 조건 선택(가격 순, 좋아요 순, 최신순), 기본값은 최신순
3. 선택된 브랜드의 상품 목록 조회

**예외 상황** :

- 브랜드ID가 전달되지 않는 경우 → `400` 에러, `올바르지 않은 브랜드입니다.` 경고 창 발생
- 존재하지 않는 브랜드 ID → `404` 에러, `존재하지 않는 브랜드입니다.` 경고 창 발생

### ✅ [FR-002] 상품 상세 조회

**Actor** : 비회원 또는 회원

**시나리오** :

1. 브랜드 선택
2. 브랜드 내 상품 선택
3. 상품 상세 정보 조회

**예외 상황:**

- 브랜드 ID 또는 상품 ID 누락 →  `400` 에러, `유효한 상품 또는 브랜드가 아닙니다` 경고 창 발생
- 존재하지 않는 상품 → `404` 에러, `존재하지 않는 상품입니다.` 경고 창 발생
- 삭제된 상품 → `410` 에러, `삭제된 상품입니다.` 경고 창 발생

### ✅ [FR-003] 브랜드 조회

**Actor** : 비회원 또는 회원

**시나리오** :

1. 브랜드 선택
2. 브랜드 정보 조회

**예외 상황** :

- 브랜드 ID 누락 → `400` 에러, `올바르지 않은 브랜드 입니다.` 경고 창 발생
- 존재하지 않는 브랜드 → `404` 에러, `존재하지 않는 브랜드입니다.` 경고 창 발생

### ✅ [FR-004] 상품 좋아요 등록

**Actor** : 회원

**시나리오** : 

1. 상품 `좋아요` 버튼(♡) 클릭 
2. 성공 시, 버튼 ♥로 변경

**예외 상황** :

- 미로그인시, `401` 에러 → 로그인 페이지로 이동
- 이미 `좋아요` 등록 한 상품인 경우, `204` 처리 및 무시
- 존재하지 않는 상품에 대한 좋아요 등록 , `404` 에러, `존재하지 않는 상품입니다` 경고 창 발생

### ✅ [FR-005] 상품 좋아요 제거

**Actor** : 회원

**시나리오** : 

1. 상품 `좋아요` 버튼(♥) 클릭
2. 성공 시, 버튼 ♡로 변경

**예외 상황** :

- 미로그인시, `401` 에러 → 로그인 페이지로 이동
- 이미 `좋아요` 제거 한 상품인 경우, `204` 처리 및 무시
- 존재하지 않는 상품에 대한 좋아요 제거 , `404` 에러, `존재하지 않는 상품입니다` 경고 창 발생

### ✅ [FR-006] 상품 좋아요 목록 조회

**Actor** : 회원

**시나리오** :

1. 관심 상품 메뉴 클릭
2. 관심 상품 목록 리스트 

**예외 상황** :

- 미로그인시, `401` 에러 → 로그인 페이지로 이동

### ✅ [FR-007,FR-008] 주문 생성 및 결제

**Actor** : 회원

**시나리오** :

1. 상품 상세 또는 장바구니에서 “주문하기” 클릭
2. 주문 생성 → 주문 ID 생성
3. 결제 요청
4. 결제 성공 시, 주문 완료 안내

**예외 상황** :

- 미로그인시, `401` 에러 → 로그인 페이지로 이동
- 재고 부족 시, 주문 생성 실패 → `409` 처리, `재고가 부족합니다.` 경고 창 발생
- 상품 개수가 음수 이거나 상품 ID 가 올바르지 않은  경우 → `400` 처리, `상품 수량 및 ID가 올바르지 않습니다.` 경고 창 발생
- 존재하지 않는 상품 ID 인 경우 → `404` 처리, `존재하지 않는 상품입니다.` 경고 창 발생

### ✅ [FR-009] 주문 목록 조회

**Actor** : 회원

**시나리오** :

1. 주문 목록 항목 선택
2. 주문 목록 리스트 

**예외 상황** :

- 미 로그인시, `401` 에러 → 로그인 페이지 이동

### ✅ [FR-010] 주문 상세 조회

**Actor** : 회원

**시나리오** : 

1. 주문 목록 → 주문 선택
2. 주문 상세 정보 조회

**예외 상황** :

- 미 로그인시, `401` 에러 → 로그인 페이지 이동
- 존재하지 않는 주문인 경우, `404` 에러 , `존재하지 않는 주문입니다` 경고 창 발생

---

## 6. 인터페이스 요구사항

| 기능ID | 설명 | 메서드 | URL | 인증 |
| --- | --- | --- | --- | --- |
| FR-001 | 상품 목록 조회 | GET | `/api/v1/products` | ❌ |
| FR-002 | 상품 상세 조회 | GET | `/api/v1/products/{id}` | ❌ |
| FR-003 | 브랜드 조회 | GET | `/api/v1/brands/{brandId}` | ❌ |
| FR-004 | 상품 좋아요 등록 | POST | `/api/v1/products/{id}/like` | ✅ |
| FR-005 | 상품 좋아요 제거 | DELETE | `/api/v1/products/{productId}/likes` | ✅ |
| FR-006 | 상품 좋아요 목록 조회 | GET | `/api/v1/users/{userId}/likes` | ✅ |
| FR-007 | 주문 생성 | POST | `/api/v1/orders` | ✅ |
| FR-008 | 결제 요청 | *내부 비지니스 |  | ✅ |
| FR-009 | 주문 조회 | GET | `/api/v1/users/{userId}/orders` | ✅ |
| FR-010 | 주문 상세 조회 | GET | `/api/v1/orders/{orderId}` | ✅ |

---

## 7. 변경 이력

| 버전 | 일자 | 작성자 | 변경 내용 |
| --- | --- | --- | --- |
| 1.0 | 2025-07-20 | 엄호용 | 최초 이커머스 요구사항 명세서 작성 |